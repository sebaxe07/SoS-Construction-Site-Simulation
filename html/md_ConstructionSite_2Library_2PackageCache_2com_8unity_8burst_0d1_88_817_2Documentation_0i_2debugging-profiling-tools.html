<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Debugging and profiling tools</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Debugging and profiling tools</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md823"></a></p>
<p>The following sections describe how to debug and profile your Burst-compiled code in the Editor and in player builds.</p>
<p>&gt;[!TIP] &gt;Before attempting to debug Burst-compiled code, enable script debugging for the Editor, or a player build by following the steps in [Debug C# code in <a class="el" href="namespaceUnity.html">Unity</a>](xref:ManagedCodeDebugging). Although you can theoretically debug Burst-compiled code even when the script compilation mode is set to Release, in practice it doesn't work reliably. Breakpoints might be skipped, and variables might not appear in the Locals window, for example.</p>
<p><a class="anchor" id="debugging-in-editor"></a></p>
<h1><a class="anchor" id="autotoc_md824"></a>
Debugging Burst-compiled code in the Editor</h1>
<p>To debug Burst-compiled code in the Editor, you can either use a managed debugger, or a native debugger. This section explains both options.</p>
<h2><a class="anchor" id="autotoc_md825"></a>
Attach a managed debugger</h2>
<p>You can attach a managed debugger such as Visual Studio, Visual Studio for Mac, or <a class="el" href="namespaceJetBrains.html">JetBrains</a> <a class="el" href="namespaceRider.html">Rider</a>. This is the same type of debugger you can use to debug regular managed C# code in your <a class="el" href="namespaceUnity.html">Unity</a> project. The ways of attaching a debugger differ depending on the version of <a class="el" href="namespaceUnity.html">Unity</a> you're using:</p>
<ul>
<li><b><a class="el" href="namespaceUnity.html">Unity</a> 2022.2+</b>: When you place a breakpoint inside Burst-compiled code, and you have a managed debugger attached, <a class="el" href="namespaceUnity.html">Unity</a> disables <a class="el" href="namespaceBurst.html">Burst</a> automatically for that code path. This allows you to use a managed debugger to debug the managed version of your code. When you remove all breakpoints from that code path, <a class="el" href="namespaceUnity.html">Unity</a> re-enables <a class="el" href="namespaceBurst.html">Burst</a> for that code path.</li>
<li><b><a class="el" href="namespaceUnity.html">Unity</a> 2022.1 and older</b>: Disable <a class="el" href="namespaceBurst.html">Burst</a>, either with the global option in the Editor <a class="el" href="md_ConstructionSite_2Library_2PackageCache_2com_8unity_8burst_0d1_88_817_2Documentation_0i_2editor-burst-menu.html">Burst menu</a> (<b>Jobs</b> &gt; <b><a class="el" href="namespaceBurst.html">Burst</a></b> &gt; <b>Enable Compilation</b>), or comment out the <code>[BurstCompile]</code> attribute from the specific entry-point that you want to debug.</li>
</ul>
<h2><a class="anchor" id="autotoc_md826"></a>
Attach a native debugger</h2>
<p>You can attach a native debugger such as Visual Studio or Xcode. Before doing so, you need to disable <a class="el" href="namespaceBurst.html">Burst</a> optimizations. You can do this in the following ways:</p>
<ul>
<li>Use the <b>Native Debug Mode Compilation</b> setting in the Editor <a class="el" href="md_ConstructionSite_2Library_2PackageCache_2com_8unity_8burst_0d1_88_817_2Documentation_0i_2editor-burst-menu.html">Burst menu</a> (<b>Jobs</b> &gt; <b><a class="el" href="namespaceBurst.html">Burst</a></b> &gt; <b>Native Debug Mode Compilation</b>). <b>Important:</b> This setting disables optimizations across all jobs, which impacts the performance of <a class="el" href="namespaceBurst.html">Burst</a> code. If you want to disable optimizations only for a specific job, use the other option in this list.</li>
<li><p class="startli">Add the <code>Debug = true</code> flag to your job, which disables optimizations and enables debugging on that specific job:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#</span></div>
<div class="line">   [BurstCompile(Debug = <span class="keyword">true</span>)]</div>
<div class="line">   <span class="keyword">public</span> <span class="keyword">struct </span>MyJob : IJob</div>
<div class="line">   {</div>
<div class="line">       <span class="comment">// ...</span></div>
<div class="line">   }</div>
</div><!-- fragment --><p class="startli">&gt;[!TIP] &gt;Player builds pick up the <code>Debug</code> flag, so you can also use this to debug a player build.</p>
</li>
</ul>
<p>To attach a native debugger to the <a class="el" href="namespaceUnity.html">Unity</a> Editor process, see the native debugging section below.</p>
<p><a class="anchor" id="debugging-in-player"></a></p>
<h1><a class="anchor" id="autotoc_md827"></a>
Debugging Burst-compiled code in a player build</h1>
<p>Because of the way that <a class="el" href="namespaceUnity.html">Unity</a> builds the code for a player, you need to tell the debugging tool where to find the symbols. To do this, point the tool to the folder that contains the <code>lib_burst_generated</code> files, which is usually in the <code>Plugins</code> folder.</p>
<p>To debug Burst-compiled code in a player build, you need to attach a native debugger (such as Visual Studio or Xcode) to the player process. Before doing so, you need to:</p>
<ul>
<li>Enable symbol generation. You can do this in either of two ways:<ul>
<li>Enable the <b>Development Build</b> option before you build the player, or</li>
<li>Enable the <b>Force Debug Information</b> option in <a class="el" href="md_ConstructionSite_2Library_2PackageCache_2com_8unity_8burst_0d1_88_817_2Documentation_0i_2building-aot-settings.html">Burst AOT Player Settings</a></li>
</ul>
</li>
<li>Disable <a class="el" href="namespaceBurst.html">Burst</a> optimizations. You can do this in either of two ways:<ul>
<li>Disable the <b>Enable Optimizations</b> option in <a class="el" href="md_ConstructionSite_2Library_2PackageCache_2com_8unity_8burst_0d1_88_817_2Documentation_0i_2building-aot-settings.html">Burst AOT Player Settings</a>. <b>Important:</b> This setting disables optimizations across all jobs, which impacts the performance of <a class="el" href="namespaceBurst.html">Burst</a> code. If you want to disable optimizations only for a specific job, use the other option in this list.</li>
<li><p class="startli">Add the <code>Debug = true</code> flag to your job, which disables optimizations and enables debugging on that specific job:</p>
<p class="startli"><code>c# [BurstCompile(Debug = true)] public struct MyJob : IJob { // ... } </code></p>
</li>
</ul>
</li>
</ul>
<p>To attach a native debugger to the player process, see the native debugging section below.</p>
<p><a class="anchor" id="native-debugging"></a></p>
<h1><a class="anchor" id="autotoc_md828"></a>
Native debugging</h1>
<p>Follow the instructions above to setup native debugging correctly for the Editor or a player build. Then, attach a native debugger such as Visual Studio or Xcode.</p>
<h2><a class="anchor" id="autotoc_md829"></a>
Native debugging limitations</h2>
<ul>
<li>Native debuggers can't discover lambda captures on <code>Entity.ForEach</code>, so you can't inspect variables originating from these.</li>
<li>Structs that use <a href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.interopservices.layoutkind?view=net-6.0"><code>[StructLayout(LayoutKind=Explicit)]</code></a> and have overlapping fields are represented by a struct that hides one of the overlaps.</li>
</ul>
<p>Types that are nested, are namespaced in C/C++ style. e.g.</p>
<div class="fragment"><div class="line"><span class="preprocessor"> #</span></div>
<div class="line"><span class="keyword">namespace </span>Pillow</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">struct </span>Spot</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">struct </span>SubSpot</div>
<div class="line">        {</div>
<div class="line">            <span class="keyword">public</span> <span class="keywordtype">int</span> a;</div>
<div class="line">            <span class="keyword">public</span> <span class="keywordtype">int</span> b;</div>
<div class="line">        }</div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">int</span> a;</div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">int</span> b;</div>
<div class="line">        <span class="keyword">public</span> SubSpot sub;</div>
<div class="line">    }</div>
</div><!-- fragment --><p>You would refer to SubSpot as Pillow::Spot::SubSpot in this case (for instance if you were trying to cast a pointer in a debugger watch window).</p>
<h2><a class="anchor" id="autotoc_md830"></a>
Code-based breakpoints</h2>
<p><a class="el" href="namespaceBurst.html">Burst</a> supports code-based breakpoints through the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.debugger.break?view=net-6.0"><code>System.Diagnostics.Debugger.Break</code></a> method. This method generates a debug trap in your code. You must attach a debugger to your code so that it can intercept the break. Breakpoints trigger whether you've attached a debugger or not.</p>
<p><a class="el" href="namespaceBurst.html">Burst</a> adds information to track local variables, function parameters and breakpoints. If your debugger supports conditional breakpoints, use these over adding breakpoints in your code, because they only fire when you've attached a debugger.</p>
<h1><a class="anchor" id="autotoc_md831"></a>
Profiling Burst-compiled code</h1>
<h2><a class="anchor" id="autotoc_md832"></a>
Profiling using standalone profiling tools</h2>
<p>You can use profiling tools (such as Instruments or Superluminal) to profile Burst-compiled code in a player build. Because of the way that <a class="el" href="namespaceUnity.html">Unity</a> builds the code for a player, you need to tell the profiling tool where to find the symbols. To do this, point the tool to the folder that contains the <code>lib_burst_generated</code> files, which is usually in the <code>Plugins</code> folder.</p>
<p><a class="anchor" id="profiler-markers"></a></p>
<h2><a class="anchor" id="autotoc_md833"></a>
Unity Profiler markers</h2>
<p>To improve the data you get from <a class="el" href="namespaceUnity.html">Unity</a> Profiler (either for Burst-compiled code running in the Editor or in an attached player), you can create <a class="el" href="namespaceUnity.html">Unity</a> Profiler markers from <a class="el" href="namespaceBurst.html">Burst</a> code by calling <code>new ProfilerMarker("MarkerName")</code>:</p>
<div class="fragment"><div class="line"><span class="preprocessor"> #</span></div>
<div class="line">[BurstCompile]</div>
<div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class </span>ProfilerMarkerWrapper</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> readonly ProfilerMarker StaticMarker = <span class="keyword">new</span> ProfilerMarker(<span class="stringliteral">&quot;TestStaticBurst&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    [BurstCompile(CompileSynchronously = <span class="keyword">true</span>)]</div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">int</span> CreateAndUseProfilerMarker(<span class="keywordtype">int</span> start)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">using</span> (StaticMarker.Auto())</div>
<div class="line">        {</div>
<div class="line">            var p = <span class="keyword">new</span> ProfilerMarker(<span class="stringliteral">&quot;TestBurst&quot;</span>);</div>
<div class="line">            p.Begin();</div>
<div class="line">            var result = 0;</div>
<div class="line">            <span class="keywordflow">for</span> (var i = start; i &lt; start + 100000; i++)</div>
<div class="line">            {</div>
<div class="line">                result += i;</div>
<div class="line">            }</div>
<div class="line">            p.End();</div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
