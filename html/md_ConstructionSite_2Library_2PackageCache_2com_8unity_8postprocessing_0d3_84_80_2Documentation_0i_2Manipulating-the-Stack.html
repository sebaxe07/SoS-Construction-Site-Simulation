<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Controlling effects using scripts</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Controlling effects using scripts</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md1418"></a></p>
<p>This guide explains how to modify a post-processing script to create time-based events or temporary post-processing effects.</p>
<h1><a class="anchor" id="autotoc_md1419"></a>
Quick Volumes</h1>
<p>Use the <code>QuickVolume</code> method to quickly spawn new volumes in the scene, to create time-based events or temporary states:</p>
<div class="fragment"><div class="line">[</div>
<div class="line"><span class="keyword">public</span> PostProcessVolume QuickVolume(<span class="keywordtype">int</span> layer, <span class="keywordtype">float</span> priority, params PostProcessEffectSettings[] settings)</div>
<div class="line">]</div>
</div><!-- fragment --><p> The following example demonstrates how to use a script to create a pulsating vignette effect:</p>
<div class="fragment"><div class="line">[</div>
<div class="line"><span class="keyword">using </span><a class="code hl_namespace" href="namespaceUnityEngine.html">UnityEngine</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_namespace" href="namespaceUnityEngine_1_1Rendering_1_1PostProcessing.html">UnityEngine.Rendering.PostProcessing</a>;</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">class </span>VignettePulse : MonoBehaviour</div>
<div class="line">{</div>
<div class="line">   <a class="code hl_class" href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessVolume.html">PostProcessVolume</a> m_Volume;</div>
<div class="line">   <a class="code hl_class" href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1Vignette.html">Vignette</a> m_Vignette</div>
<div class="line">   <span class="keywordtype">void</span> Start()</div>
<div class="line">  {</div>
<div class="line">      <span class="comment">// Create an instance of a vignette</span></div>
<div class="line">       m_Vignette = ScriptableObject.CreateInstance&lt;<a class="code hl_class" href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1Vignette.html">Vignette</a>&gt;();</div>
<div class="line">       m_Vignette.<a class="code hl_variable" href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessEffectSettings.html#a5f8e8b852eddd13d488461b28cdc0cb6">enabled</a>.<a class="code hl_function" href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1ParameterOverride.html#ae61932326ae9f196d9d385d2b9718feb">Override</a>(<span class="keyword">true</span>);</div>
<div class="line">       m_Vignette.intensity.Override(1f);</div>
<div class="line">      <span class="comment">// Use the QuickVolume method to create a volume with a priority of 100, and assign the vignette to this volume</span></div>
<div class="line">       m_Volume = <a class="code hl_class" href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessManager.html">PostProcessManager</a>.<a class="code hl_property" href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessManager.html#af158b62068ee203e62aa33c585ccbd56">instance</a>.<a class="code hl_function" href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessManager.html#a4e2b09fcf1ace474b5fe4ab8dcf8f53a">QuickVolume</a>(gameObject.layer, 100f, m_Vignette);</div>
<div class="line">   <span class="keywordtype">void</span> Update()</div>
<div class="line">  {</div>
<div class="line">       <span class="comment">// Change vignette intensity using a sinus curve</span></div>
<div class="line">        m_Vignette.intensity.value = Mathf.Sin(Time.realtimeSinceStartup);</div>
<div class="line">  }</div>
<div class="line">   <span class="keywordtype">void</span> OnDestroy()</div>
<div class="line">  {</div>
<div class="line">       RuntimeUtilities.DestroyVolume(m_Volume, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="aclassUnityEngine_1_1Rendering_1_1PostProcessing_1_1ParameterOverride_html_ae61932326ae9f196d9d385d2b9718feb"><div class="ttname"><a href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1ParameterOverride.html#ae61932326ae9f196d9d385d2b9718feb">UnityEngine.Rendering.PostProcessing.ParameterOverride.Override</a></div><div class="ttdeci">void Override(T x)</div><div class="ttdoc">Sets the value for this parameter to x  and mark the override state to true.</div><div class="ttdef"><b>Definition</b> ParameterOverride.cs:147</div></div>
<div class="ttc" id="aclassUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessEffectSettings_html_a5f8e8b852eddd13d488461b28cdc0cb6"><div class="ttname"><a href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessEffectSettings.html#a5f8e8b852eddd13d488461b28cdc0cb6">UnityEngine.Rendering.PostProcessing.PostProcessEffectSettings.enabled</a></div><div class="ttdeci">BoolParameter enabled</div><div class="ttdoc">The true state of the effect override in the stack. Setting this to false will disable rendering for ...</div><div class="ttdef"><b>Definition</b> PostProcessEffectSettings.cs:44</div></div>
<div class="ttc" id="aclassUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessManager_html"><div class="ttname"><a href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessManager.html">UnityEngine.Rendering.PostProcessing.PostProcessManager</a></div><div class="ttdoc">This manager tracks all volumes in the scene and does all the interpolation work. It is automatically...</div><div class="ttdef"><b>Definition</b> PostProcessManager.cs:13</div></div>
<div class="ttc" id="aclassUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessManager_html_a4e2b09fcf1ace474b5fe4ab8dcf8f53a"><div class="ttname"><a href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessManager.html#a4e2b09fcf1ace474b5fe4ab8dcf8f53a">UnityEngine.Rendering.PostProcessing.PostProcessManager.QuickVolume</a></div><div class="ttdeci">PostProcessVolume QuickVolume(int layer, float priority, params PostProcessEffectSettings[] settings)</div><div class="ttdoc">Helper method to spawn a new volume in the scene.</div><div class="ttdef"><b>Definition</b> PostProcessManager.cs:216</div></div>
<div class="ttc" id="aclassUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessManager_html_af158b62068ee203e62aa33c585ccbd56"><div class="ttname"><a href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessManager.html#af158b62068ee203e62aa33c585ccbd56">UnityEngine.Rendering.PostProcessing.PostProcessManager.instance</a></div><div class="ttdeci">static PostProcessManager instance</div><div class="ttdoc">The current singleton instance of PostProcessManager.</div><div class="ttdef"><b>Definition</b> PostProcessManager.cs:20</div></div>
<div class="ttc" id="aclassUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessVolume_html"><div class="ttname"><a href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessVolume.html">UnityEngine.Rendering.PostProcessing.PostProcessVolume</a></div><div class="ttdoc">A post-process volume component holding a post-process profile.</div><div class="ttdef"><b>Definition</b> PostProcessVolume.cs:65</div></div>
<div class="ttc" id="aclassUnityEngine_1_1Rendering_1_1PostProcessing_1_1Vignette_html"><div class="ttname"><a href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1Vignette.html">UnityEngine.Rendering.PostProcessing.Vignette</a></div><div class="ttdoc">This class holds settings for the Vignette effect.</div><div class="ttdef"><b>Definition</b> Vignette.cs:33</div></div>
<div class="ttc" id="anamespaceUnityEngine_1_1Rendering_1_1PostProcessing_html"><div class="ttname"><a href="namespaceUnityEngine_1_1Rendering_1_1PostProcessing.html">UnityEngine.Rendering.PostProcessing</a></div><div class="ttdef"><b>Definition</b> DisplayNameAttribute.cs:4</div></div>
<div class="ttc" id="anamespaceUnityEngine_html"><div class="ttname"><a href="namespaceUnityEngine.html">UnityEngine</a></div><div class="ttdef"><b>Definition</b> IAnimationPreviewable.cs:4</div></div>
</div><!-- fragment --><p>This code creates a new vignette and assigns it to a newly spawned volume. Then, on every frame, it changes the vignette intensity.To avoid memory leaks, destroy the volume and the attached profile when you don’t need them anymore.</p>
<h1><a class="anchor" id="autotoc_md1420"></a>
Using tweening libraries with effects</h1>
<p>To change the parameters of effect over time or based on a gameplay event, you can manipulate Volume or effect parameters. You can do this in an Update method (as demonstrated in the vignette example above), or you can use a tweening library.</p>
<p>A tweening library is a code library that provides utility functions for simple, code-based animations called "tweens". A few third-party tweening libraries are available for <a class="el" href="namespaceUnity.html">Unity</a> for free, such as<a href="http://dotween.demigiant.com/">DOTween</a>,<a href="http://www.pixelplacement.com/itween/index.php">iTween</a> or<a href="https://github.com/dentedpixel/LeanTween">LeanTween</a>. The following example uses DOTween. For more information, see the <a href="http://dotween.demigiant.com/documentation.php">DOTween documentation</a>.</p>
<p>This example spawns a volume with a vignette. Its weight is initially set to 0. The code uses the <a href="http://dotween.demigiant.com/documentation.php#creatingSequence">sequencing feature</a> of DOTween to chain a set of tweening events that set the value of the weight parameter: fade in, pause for a second, fade out. After this sequence has completed, the code destroys the Volume and the <code>Vignette Pulse</code> component.</p>
<div class="fragment"><div class="line"><span class="keyword">using </span><a class="code hl_namespace" href="namespaceUnityEngine.html">UnityEngine</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_namespace" href="namespaceUnityEngine_1_1Rendering_1_1PostProcessing.html">UnityEngine.Rendering.PostProcessing</a>;</div>
<div class="line"><span class="keyword">using </span>DG.Tweening;</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">class </span>VignettePulse : MonoBehaviour</div>
<div class="line">{</div>
<div class="line">   <span class="keywordtype">void</span> Start()</div>
<div class="line">  {</div>
<div class="line">       var vignette = ScriptableObject.CreateInstance&lt;<a class="code hl_class" href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1Vignette.html">Vignette</a>&gt;();</div>
<div class="line">       vignette.<a class="code hl_variable" href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessEffectSettings.html#a5f8e8b852eddd13d488461b28cdc0cb6">enabled</a>.<a class="code hl_function" href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1ParameterOverride.html#ae61932326ae9f196d9d385d2b9718feb">Override</a>(<span class="keyword">true</span>);</div>
<div class="line">       vignette.intensity.Override(1f);</div>
<div class="line">       var volume = <a class="code hl_class" href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessManager.html">PostProcessManager</a>.<a class="code hl_property" href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessManager.html#af158b62068ee203e62aa33c585ccbd56">instance</a>.<a class="code hl_function" href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessManager.html#a4e2b09fcf1ace474b5fe4ab8dcf8f53a">QuickVolume</a>(gameObject.layer, 100f, vignette);</div>
<div class="line">       volume.weight = 0f;</div>
<div class="line">       DOTween.Sequence()</div>
<div class="line">          .Append(DOTween.To(() =&gt; volume.weight, x =&gt; volume.weight = x, 1f, 1f))</div>
<div class="line">          .AppendInterval(1f)</div>
<div class="line">          .Append(DOTween.To(() =&gt; volume.weight, x =&gt; volume.weight = x, 0f, 1f))</div>
<div class="line">          .OnComplete(() =&gt;</div>
<div class="line">          {</div>
<div class="line">               RuntimeUtilities.DestroyVolume(volume, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line">               Destroy(<span class="keyword">this</span>);</div>
<div class="line">          });</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1421"></a>
Profile Editing</h1>
<p>The above examples demonstrate how to create new effects and Volumes at runtime, but you can also manually edit an existing Profile that is used by one or more Volumes. To do this, you can use one of two fields on the <code>PostProcessVolume</code> . Each field has a slightly different effects:</p>
<ul>
<li>Modify the shared profile directly:<ul>
<li>Class field name: <a href="...api/UnityEngine.Rendering.PostProcessing.PostProcessVolume.html#UnityEngine_Rendering_PostProcessing_PostProcessVolume_sharedProfile.html"><code>sharedProfile</code></a></li>
<li>Applies changes to all volumes using the same profile</li>
<li>Modifies the asset and doesn’t reset when you exit play mode</li>
</ul>
</li>
<li>Request a clone of the shared Profile that will only be used for this Volume:<ul>
<li>Class field name: <a href="...api/UnityEngine.Rendering.PostProcessing.PostProcessVolume.html#UnityEngine_Rendering_PostProcessing_PostProcessVolume_profile.html"><code>profile</code></a></li>
<li>Applies changes to the specified volume</li>
<li>Resets when you exit play mode</li>
<li>You must manually destroy the profile when you don't need it anymore</li>
</ul>
</li>
</ul>
<p>The <code>PostProcessProfile</code> class contains the following utility methods to help you manage assigned effects: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Utility method   </th><th class="markdownTableHeadNone"><b>Description</b>    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="...api/UnityEngine.Rendering.PostProcessing.PostProcessProfile.html#UnityEngine_Rendering_PostProcessing_PostProcessProfile_AddSettings__1"><code>T AddSettings()</code></a>   </td><td class="markdownTableBodyNone">Creates, adds and returns a new effect of type <code>T</code> to the profile. It throws an exception if it already exist    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="api/UnityEngine.Rendering.PostProcessing.PostProcessProfile.html#UnityEngine_Rendering_PostProcessing_PostProcessProfile_AddSettings_UnityEngine_Rendering_PostProcessing_PostProcessEffectSettings_"><code>PostProcessEffectSettings AddSettings(PostProcessEffectSettings effect)</code></a>   </td><td class="markdownTableBodyNone">Adds and returns an effect that you created to the profile.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="api/UnityEngine.Rendering.PostProcessing.PostProcessProfile.html#UnityEngine_Rendering_PostProcessing_PostProcessProfile_RemoveSettings__1"><code>void RemoveSettings()</code></a>   </td><td class="markdownTableBodyNone">Removes an effect from the profile. It throws an exception if it doesn't exist.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="...api/UnityEngine.Rendering.PostProcessing.PostProcessProfile.html#UnityEngine_Rendering_PostProcessing_PostProcessProfile_TryGetSettings__1___0__"><code>bool TryGetSettings(out T outSetting)</code></a>   </td><td class="markdownTableBodyNone">Gets an effect from the profile, returns <code>true</code> if it found a profile, or <code>false</code> if it did not find a profile.   </td></tr>
</table>
<p>You can find more methods in the <code>/PostProcessing/Runtime/PostProcessProfile.cs</code> source file.</p>
<p><b>Important:</b> You must destroy any manually created profiles or effects.</p>
<h1><a class="anchor" id="autotoc_md1422"></a>
Additional notes</h1>
<p>If you need to instantiate <code>PostProcessLayer</code> at runtime, you must bind your resources to it. To do this, add your component and call <code>Init()</code> on your <code>PostProcessLayer</code> with a reference to the <code>PostProcessResources</code> file as a parameter.</p>
<p>Here is an example:</p>
<div class="fragment"><div class="line">var postProcessLayer = gameObject.AddComponent&lt;<a class="code hl_class" href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessLayer.html">PostProcessLayer</a>&gt;();</div>
<div class="line">postProcessLayer.<a class="code hl_function" href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessLayer.html#ae512d299cd9948f8ab7888ec3a293bf6">Init</a>(resources);</div>
<div class="ttc" id="aclassUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessLayer_html"><div class="ttname"><a href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessLayer.html">UnityEngine.Rendering.PostProcessing.PostProcessLayer</a></div><div class="ttdoc">This is the component responsible for rendering post-processing effects. It must be put on every came...</div><div class="ttdef"><b>Definition</b> PostProcessLayer.cs:25</div></div>
<div class="ttc" id="aclassUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessLayer_html_ae512d299cd9948f8ab7888ec3a293bf6"><div class="ttname"><a href="classUnityEngine_1_1Rendering_1_1PostProcessing_1_1PostProcessLayer.html#ae512d299cd9948f8ab7888ec3a293bf6">UnityEngine.Rendering.PostProcessing.PostProcessLayer.Init</a></div><div class="ttdeci">void Init(PostProcessResources resources)</div><div class="ttdoc">Initializes this layer. If you create the layer via scripting you should always call this method.</div><div class="ttdef"><b>Definition</b> PostProcessLayer.cs:286</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
