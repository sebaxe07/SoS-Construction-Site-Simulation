<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Example: How to create a custom rendering effect using the Render Objects Renderer Feature</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Example: How to create a custom rendering effect using the Render Objects Renderer Feature</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md2289"></a></p>
<p>URP draws objects in the <b>DrawOpaqueObjects</b> and <b>DrawTransparentObjects</b> passes. You might need to draw objects at a different point in the frame rendering, or interpret and write rendering data (like depth and stencil) in alternate ways. The <a class="el" href="md_ConstructionSite_2Library_2PackageCache_2com_8unity_8render-pipelines_8universal_0d14_80_811_e9070690e10dcda6766da1d4ca23a070.html">Render Objects Renderer Feature</a> lets you do such customizations by letting you draw objects on a certain layer, at a certain time, with specific overrides.</p>
<p>The example on this page describes how to create a custom rendering effect with the Render Objects Renderer Feature.</p>
<h1><a class="anchor" id="autotoc_md2290"></a>
Example overview</h1>
<p>The example on this page demonstrates how to implement the following effect:</p>
<ul>
<li><p class="startli">There is a character in the Scene.</p>
<p class="startli"><img src="../Images/how-to-render-objects/character.png" alt="Character" class="inline"/></p>
</li>
<li><p class="startli">When the character goes behind GameObjects, <a class="el" href="namespaceUnity.html">Unity</a> draws the character silhouette with a different Material.</p>
<p class="startli"><img src="../Images/how-to-render-objects/character-goes-behind-object.gif" alt="Character goes behind GameObjects" class="inline"/></p>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md2291"></a>
Prerequisites</h1>
<p>This example requires the following:</p>
<ul>
<li>A <a class="el" href="namespaceUnity.html">Unity</a> project with the URP package installed.</li>
<li>The <b>Scriptable Render Pipeline Settings</b> property refers to a URP asset (<b>Project Settings</b> &gt; <b><a class="el" href="namespaceGraphics.html">Graphics</a></b> &gt; <b>Scriptable Render Pipeline Settings</b>).</li>
</ul>
<h1><a class="anchor" id="autotoc_md2292"></a>
Create example Scene and GameObjects<a class="anchor" id="example-objects"></a></h1>
<p>To follow the steps in this example, create a new Scene with the following GameObjects:</p>
<ol type="1">
<li><p class="startli">Create a Cube. Set its <b>Scale</b> values so that it looks like a wall.</p>
<p class="startli"><img src="../Images/how-to-render-objects/rendobj-cube-wall.png" alt="Cube that represents a wall" class="inline"/></p>
</li>
<li>Create a Material and assign it the <code>Universal Render Pipeline/Lit</code> shader. Select the base color (for example, red). Call the Material <code>Character</code>.</li>
<li><p class="startli">Create a basic character and assign it the Character Material. In this example, the character consists of three capsules: the big capsule in the center represents the body, and the two smaller capsules represent the hands.</p>
<p class="startli"><img src="../Images/how-to-render-objects/character-views-side-top-persp.png" alt="The character consisting of three capsules" class="inline"/></p>
<p class="startli">To make it easier to manipulate the character in the Scene, add the three Capsules as child GameObjects under the Character GameObject.</p>
<p class="startli"><img src="../Images/how-to-render-objects/character-in-hierarchy.png" alt="Character objects in Hierarchy" class="inline"/></p>
</li>
<li>Create a Material and assign it the <code>Universal Render Pipeline/Unlit</code> shader. Select the base color that you would like the character to have when it's behind GameObjects (for example, blue). Call the Material <code>CharacterBehindObjects</code>.</li>
</ol>
<p>Now you have the setup necessary to follow the steps in this example.</p>
<h1><a class="anchor" id="autotoc_md2293"></a>
Example implementation</h1>
<p>This section assumes that you created a Scene as described in section Example Scene and GameObjects.</p>
<p>The example implementation uses two Render Objects Renderer Features: one to draw parts of the character that are behind other GameObjects, and another one to draw the parts of the character that are in front of other GameObjects.</p>
<h2><a class="anchor" id="autotoc_md2294"></a>
Create a Renderer Feature to draw the character behind GameObjects</h2>
<p>Follow these steps to create a Renderer Feature to draw the character behind GameObjects.</p>
<ol type="1">
<li><p class="startli">Select a URP Renderer.</p>
<p class="startli"><img src="../Images/how-to-render-objects/rendobj-select-urp-renderer.png" alt="Select a URP Renderer" class="inline"/></p>
</li>
<li><p class="startli">In the Inspector, click <b>Add Renderer Feature</b> and select <b>Render Objects</b>.</p>
<p class="startli"><img src="../Images/how-to-render-objects/rendobj-add-rend-obj.png" alt="Add Render Object Renderer Feature" class="inline"/></p>
<p class="startli">Select the <b>Name</b> field and enter the name of the new Renderer Feature, for example, <b>DrawCharacterBehind</b>.</p>
</li>
<li><p class="startli">This example uses Layers to filter the GameObjects to render. Create a new Layer and call it <b>Character</b>.</p>
<p class="startli"><img src="../Images/how-to-render-objects/rendobj-new-layer-character.png" alt="Create new Layer called Character" class="inline"/></p>
</li>
<li>Select the <b>Character</b> GameObject and assign it to the <code>Character</code> Layer. To do this, open the Layer drop down and select <code>Character</code>. <img src="../Images/how-to-render-objects/rendobj-assign-character-gameobject-layer.png" alt="Assign Character GameObject to Character Layer" class="inline"/></li>
<li>In the <code>DrawCharacterBehind</code> Renderer Feature, in <b>Filters</b> &gt; <b>Layer Mask</b>, select <code>Character</code>. With this setting, this Renderer Feature renders GameObjects only in the Layer <code>Character</code>.</li>
<li><p class="startli">In <b>Overrides</b> &gt; <b>Material</b>, select the <code>CharacterBehindObjects</code> Material.</p>
<p class="startli">The Renderer Feature overrides the Material of a GameObject with the selected Material.</p>
<p class="startli"><img src="../Images/how-to-render-objects/rendobj-change-layer-override-material.png" alt="Layer Mask, Material Override" class="inline"/></p>
</li>
<li><p class="startli">The intended behavior is that the Renderer Feature renders the character with the <code>CharacterBehindObjects</code> Material only when the character is behind other GameObjects.</p>
<p class="startli">To achieve this, select the <b>Depth</b> check box, and set the <b>Depth Test</b> property to <b>Greater</b>.</p>
<p class="startli"><img src="../Images/how-to-render-objects/rendobj-depth-greater.png" alt="Set Depth Test to Greater" class="inline"/></p>
</li>
</ol>
<p>With these settings, <a class="el" href="namespaceUnity.html">Unity</a> renders the character with the <code>CharacterBehindObjects</code> Material only when the character is behind another GameObject. However, <a class="el" href="namespaceUnity.html">Unity</a> also renders parts of the character using the <code>CharacterBehindObjects</code> Material, because some parts of the character occlude the character itself.</p>
<p><img src="../Images/how-to-render-objects/character-depth-test-greater.gif" alt="Unity renders parts of the character using the `CharacterBehindObjects` Material" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md2295"></a>
Create an extra Renderer Feature to avoid the self see-through effect</h2>
<p>The settings in the previous section result in the self see-through effect for the following reason:</p>
<ul>
<li><p class="startli">When performing the Opaque rendering pass of the URP Renderer, <a class="el" href="namespaceUnity.html">Unity</a> renders all GameObjects belonging to the character with the <code>Character</code> Material and writes depth values to the Depth buffer. This happens before <a class="el" href="namespaceUnity.html">Unity</a> starts executing the <code>DrawCharacterBehind</code> Renderer Feature, because, by default, new Render Objects Renderer Features have the value <b>AfterRenderingOpaques</b> in the <b>Event</b> property.</p>
<p class="startli">The <b>Event</b> property defines the injection point where <a class="el" href="namespaceUnity.html">Unity</a> injects Render Passes from the Render Objects Renderer Feature. The event when URP Renderer draws GameObjects in the <b>Opaque Layer Mask</b> is the <b>BeforeRenderingOpaques</b> event.</p>
</li>
<li><p class="startli">When executing the <code>DrawCharacterBehind</code> Renderer Feature, <a class="el" href="namespaceUnity.html">Unity</a> performs the depth test using the condition specified in the <b>Depth Test</b> property. In the following screenshot, a bigger capsule occludes part of the smaller capsule, and the depth test passes for that part of the smaller capsule. The Renderer Feature overrides the Material for that part.</p>
<p class="startli"><img src="../Images/how-to-render-objects/rendobj-depth-greater-see-through.png" alt="Self see-through effect" class="inline"/></p>
</li>
</ul>
<p>The following steps describe how to avoid such behavior and ensure that <a class="el" href="namespaceUnity.html">Unity</a> draws all parts of the character with proper Materials.</p>
<ol type="1">
<li><p class="startli">In the URP asset, in <b>Filtering</b> &gt; <b>Opaque Layer Mask</b>, clear the check mark next to the <code>Character</code> Layer.</p>
<p class="startli"><img src="../Images/how-to-render-objects/rendobj-in-urp-asset-clear-character.png" alt="Clear the check mark next to the `Character` Layer" class="inline"/></p>
<p class="startli">Now <a class="el" href="namespaceUnity.html">Unity</a> does not render the character unless it's behind a GameObject.</p>
<p class="startli"><img src="../Images/how-to-render-objects/rendobj-character-only-behind.png" alt="Unity does not render the character unless it's behind an object" class="inline"/></p>
</li>
<li>Add a new Render Objects Renderer Feature, and call it <code>Character</code>.</li>
<li><p class="startli">In the <code>Character</code> Renderer Feature, in <b>Filters</b> &gt; <b>Layer Mask</b>, select the <code>Character</code> Layer.</p>
<p class="startli"><img src="../Images/how-to-render-objects/rendobj-render-objects-character.png" alt="Set Layer Mask Filter to Character Layer" class="inline"/></p>
<p class="startli">Now <a class="el" href="namespaceUnity.html">Unity</a> renders the character with the <code>Character</code> Material even when the character is behind GameObjects.</p>
<p class="startli">This happens because the <code>DrawCharacterBehind</code> Renderer Feature writes values to the depth buffer. When <a class="el" href="namespaceUnity.html">Unity</a> executes the <code>Character</code> Renderer Feature, the pixels on the character appear to be in front of the pixels that <a class="el" href="namespaceUnity.html">Unity</a> has drawn previously, and <a class="el" href="namespaceUnity.html">Unity</a> draws on top of those pixels.</p>
</li>
<li><p class="startli">In the <code>DrawCharacterBehind</code> Renderer Feature, In <b>Overrides</b> &gt; <b>Depth</b>, clear the <b>Write Depth</b> check box. With this setting, the <code>DrawCharacterBehind</code> Renderer Feature does not make changes to the depth buffer and the <code>Character</code> Renderer Feature does not draw the character when it's behind GameObjects.</p>
<p class="startli"><img src="../Images/how-to-render-objects/rendobj-render-objects-no-write-depth.png" alt="Clear Write Depth" class="inline"/></p>
</li>
</ol>
<p>The example is complete. When the character goes behind GameObjects, <a class="el" href="namespaceUnity.html">Unity</a> draws the character silhouette with the <code>CharacterBehindObjects</code> Material.</p>
<p><img src="../Images/how-to-render-objects/character-goes-behind-object.gif" alt="Character goes behind objects" class="inline"/></p>
<p>With the extra <code>Character</code> Renderer Feature, <a class="el" href="namespaceUnity.html">Unity</a> renders GameObjects as follows:</p>
<ol type="1">
<li>URP Renderer does not render the <code>Character</code> GameObject in the <b>BeforeRenderingOpaques</b> event, because the <code>Character</code> Layer is excluded from the <b>Opaque Layer Mask</b> list.</li>
<li>The <code>DrawCharacterBehind</code> Renderer Feature draws parts of the character that are behind other GameObjects. This happens in the <b>AfterRenderingOpaques</b> event.</li>
<li>The <code>Character</code> Renderer Feature draws parts of the character that are in front of other GameObjects. This happens in the <b>AfterRenderingOpaques</b> event, and after executing the <code>DrawCharacterBehind</code> Renderer Feature. </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
