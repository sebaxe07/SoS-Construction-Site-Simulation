<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Blit Camera color texture to RTHandle</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Blit Camera color texture to RTHandle</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md1956"></a></p>
<p>This page describes the operation of blitting a camera color texture to an output texture, and setting the output texture as a global property. The shaders in the Scene use the global texture. The description uses the <a href="../package-sample-urp-package-samples.md#renderer-features">BlitToRTHandle</a> scene from the URP package samples.</p>
<p>The code samples on the page are from the following Scene from the <a class="el" href="md_ConstructionSite_2Library_2PackageCache_2com_8unity_8render-pipelines_8universal_0d14_80_811_37a266c4635012a723860c8b456a3cfd.html">URP Package Samples</a>: </p><pre class="fragment">* Assets &gt; Samples &gt; Universal RP &gt; 14.0.9 &gt; URP Package Samples &gt; RendererFeatures &gt; BlitToRTHandle
</pre><p>The sample Scene uses the following assets to perform the blit operation:</p>
<ul>
<li>A <a href="xref:UnityEngine.Rendering.Universal.ScriptableRendererFeature">scriptable Renderer Feature</a> that enqueues a <a href="xref:UnityEngine.Rendering.Universal.ScriptableRenderPass">render pass</a> for execution.</li>
<li>A <a href="xref:UnityEngine.Rendering.Universal.ScriptableRenderPass">render pass</a> that blits a camera color texture to an output texture, and sets the output texture as a global property.</li>
</ul>
<p>Import <a class="el" href="md_ConstructionSite_2Library_2PackageCache_2com_8unity_8render-pipelines_8universal_0d14_80_811_37a266c4635012a723860c8b456a3cfd.html">URP Package Samples</a> to access the complete source code and the Scene.</p>
<p>For general information on the blit operation, refer to <a class="el" href="md_ConstructionSite_2Library_2PackageCache_2com_8unity_8render-pipelines_8universal_0d14_80_811_9b5876873e35d4cf0a3e9c37f70ac96c.html">URP blit best practices</a>.</p>
<h1><a class="anchor" id="autotoc_md1957"></a>
Define RTHandles in a render pass</h1>
<p>The <a href="xref:UnityEngine.Rendering.Universal.ScriptableRenderPass">ScriptableRenderPass</a> in the sample implementation defines the <code>RTHandle</code> variables for storing the input and the output textures.</p>
<div class="fragment"><div class="line"><span class="preprocessor"> #</span></div>
<div class="line"><span class="keyword">private</span> RTHandle m_InputHandle;</div>
<div class="line"><span class="keyword">private</span> RTHandle m_OutputHandle;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1958"></a>
Configure the input and output textures</h1>
<p>This section describes how the sample uses the <code>RTHandle</code> variables to configure the input and output textures.</p>
<h2><a class="anchor" id="autotoc_md1959"></a>
Input texture</h2>
<p>In this example, the <a href="xref:UnityEngine.Rendering.Universal.ScriptableRendererFeature">Renderer Feature</a> uses the <code>SetInput</code> method in the render pass to set the input texture:</p>
<div class="fragment"><div class="line"><span class="preprocessor"> #</span></div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> SetInput(RTHandle src)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// The Renderer Feature uses this variable to set the input RTHandle.</span></div>
<div class="line">    m_InputHandle = src;</div>
<div class="line">}</div>
</div><!-- fragment --><p>The Renderer Feature calls the <code>SetInput</code> method in the <code>SetupRenderPasses</code> method:</p>
<div class="fragment"><div class="line"><span class="preprocessor"> #</span></div>
<div class="line"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keywordtype">void</span> SetupRenderPasses(ScriptableRenderer renderer, in RenderingData renderingData)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (renderingData.cameraData.cameraType != CameraType.Game)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    </div>
<div class="line">    m_CopyColorPass.SetInput(renderer.cameraColorTargetHandle);</div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>To set the <code>m_InputHandle</code> variable directly in the render pass, without calling the <code>SetInput</code> method, use the following code in the <code>Execute</code> method: <div class="fragment"><div class="line"><span class="preprocessor"> #</span></div>
<div class="line">m_InputHandle = renderingData.cameraData.renderer.cameraColorTargetHandle;</div>
</div><!-- fragment --></dd></dl>
<h2><a class="anchor" id="autotoc_md1960"></a>
Output texture</h2>
<p>The <code>Configure</code> method configures the output texture for the blit operation.</p>
<p>The <code>ReAllocateIfNeeded</code> method creates a temporary render texture within the RTHandle system.</p>
<div class="fragment"><div class="line"><span class="preprocessor"> #</span></div>
<div class="line"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keywordtype">void</span> Configure(CommandBuffer cmd, RenderTextureDescriptor cameraTextureDescriptor)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Configure the custom RTHandle</span></div>
<div class="line">    var desc = cameraTextureDescriptor;</div>
<div class="line">    desc.depthBufferBits = 0;</div>
<div class="line">    desc.msaaSamples = 1;</div>
<div class="line">    RenderingUtils.ReAllocateIfNeeded(ref m_OutputHandle, desc, FilterMode.Bilinear, TextureWrapMode.Clamp, name: k_OutputName );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Set the RTHandle as the output target</span></div>
<div class="line">    ConfigureTarget(m_OutputHandle);</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1961"></a>
Bind a source texture with the Blitter API</h1>
<p>By default, the <b>Blitter</b> API binds a source texture with the name <code>_BlitTexture</code> in the <code>Blitter.BlitCameraTexture</code> method. The example uses this texture for the <code>m_InputHandle</code> variable.</p>
<p>The Shader Graph for the Material that the Renderer Feature uses contains the <code>_BlitTexture</code> property:</p>
<p><img src="../Images/customizing-urp/blit/blit-to-rthandle-sample-bind-texture.png" alt="_BlitTexture property in Shader Graph" class="inline"/><br  />
*_BlitTexture property in Shader Graph*</p>
<dl class="section note"><dt>Note</dt><dd>In this particular example, you can achieve the same effect by using the <b>URP <a class="el" href="classSample.html">Sample</a> Buffer</b> node instead of the <b><a class="el" href="classSample.html">Sample</a> Texture 2D</b> node. In the <b>URP <a class="el" href="classSample.html">Sample</a> Buffer</b> node, set <b>Source Buffer</b> to <code>BlitSource</code>, and the input value to <code>Default</code>.</dd>
<dd>
If you want to perform a direct copy of the input texture without applying any effects, it's not necessary to provide a Material as a parameter to the <code>BlitCameraTexture</code> method. You can use the following code instead of the <code>Blitter.BlitCameraTexture</code> line in the sample: <div class="fragment"><div class="line"><span class="preprocessor"> #</span></div>
<div class="line">Blitter.BlitCameraTexture(cmd, m_InputHandle, m_OutputHandle, 0, <span class="keyword">true</span>);</div>
</div><!-- fragment --></dd></dl>
<p>Refer to the following page for more information on the <b>Blitter</b> API: <a href="xref:UnityEngine.Rendering.Blitter">UnityEngine.Rendering.Blitter</a>.</p>
<h1><a class="anchor" id="autotoc_md1962"></a>
Perform the blit operation</h1>
<p>In the render pass, the <code>BlitCameraTexture</code> method from the <a href="xref:UnityEngine.Rendering.Blitter">Blitter API</a> performs the blit operation.</p>
<div class="fragment"><div class="line"><span class="preprocessor"> #</span></div>
<div class="line"><span class="keyword">using</span> (<span class="keyword">new</span> ProfilingScope(cmd, m_ProfilingSampler))</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Blit the input RTHandle to the output one</span></div>
<div class="line">    Blitter.BlitCameraTexture(cmd, m_InputHandle, m_OutputHandle, m_Material, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Make the output texture available for the shaders in the scene</span></div>
<div class="line">    cmd.SetGlobalTexture(m_OutputId, m_OutputHandle.nameID);</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1963"></a>
Additional resources</h1>
<ul>
<li><p class="startli"><a class="el" href="md_ConstructionSite_2Library_2PackageCache_2com_8unity_8render-pipelines_8universal_0d14_80_811_8ee8362a239c8f6f242448036a3c6713.html">Perform a full screen blit in URP</a></p>
<p class="startli">This page describes a basic blit operation and provides a complete step-by-step description of the implementation.</p>
</li>
<li><p class="startli"><a class="el" href="md_ConstructionSite_2Library_2PackageCache_2com_8unity_8render-pipelines_8universal_0d14_80_811_43ab613c728d9c76714e0854a6aa05fa.html">Blit multiple RTHandle textures and draw them on the screen</a></p>
<p class="startli">This page describes a more complex blit operation that uses multiple textures defined as <code>RTHandle</code>. </p>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
