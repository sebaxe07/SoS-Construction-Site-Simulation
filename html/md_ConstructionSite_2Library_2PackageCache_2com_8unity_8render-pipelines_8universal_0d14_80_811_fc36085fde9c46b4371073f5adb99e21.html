<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Shader Stripping</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Shader Stripping</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md2385"></a></p>
<p>The shaders in the Universal Render Pipeline (URP) use <a href="https://docs.unity3d.com/Manual/shader-keywords">shader keywords</a> to support many different features, which can mean <a class="el" href="namespaceUnity.html">Unity</a> compiles a lot of <a href="https://docs.unity3d.com/Manual/shader-variants">shader variants</a>.</p>
<p>If you disable features in the <a class="el" href="md_ConstructionSite_2Library_2PackageCache_2com_8unity_8render-pipelines_8universal_0d14_80_811_691b203f5d6feee4924a5c745cae6e21.html">URP Asset</a>, URP automatically excludes ('strips') the related shader variants. This speeds up builds, and reduces memory usage and file sizes.</p>
<p>For example, if your project doesn't use shadows for directional lights, by default <a class="el" href="namespaceUnity.html">Unity</a> still includes variants that support directional light shadows in your build. If you disable <b>Cast Shadows</b> in the URP Asset, URP strips these variants.</p>
<p>If you want to examine the code that strips shaders in URP, refer to the <code>Editor/ShaderPreprocessor.cs</code> file. The file uses the <a href="https://docs.unity3d.com/ScriptReference/Build.IPreprocessShaders.html">IPreprocessShaders</a> API.</p>
<p>For more information on stripping shader variants, refer to the following pages:</p>
<ul>
<li><a href="https://docs.unity3d.com/Manual/shader-how-many-variants.html">Check how many shader variants you have</a>.</li>
<li><a href="https://docs.unity3d.com/Manual/shader-variant-stripping.html">Standard guidance about shader stripping</a>, which applies to all render pipelines.</li>
</ul>
<h1><a class="anchor" id="autotoc_md2386"></a>
Strip feature shader variants</h1>
<p>By default, URP compiles variants where a feature is enabled, and variants where a feature is disabled.</p>
<p>To reduce the number of variants, you can enable <b>Strip Unused Variants</b> in the <a class="el" href="md_ConstructionSite_2Library_2PackageCache_2com_8unity_8render-pipelines_8universal_0d14_80_811_02b8c98dd946abe06dca7ebdbe0d6e09.html">URP Global Settings</a> and do the following:</p>
<ul>
<li>Disable a feature in all URP Assets in your build, so URP keeps only variants where the feature is disabled.</li>
<li>Enable a feature in all URP Assets in your build, so URP keeps only variants where the feature is enabled.</li>
</ul>
<p>If you disable the <b>Strip Unused Variants setting</b>, URP can't strip variants where the feature is disabled. This might increase the number of variants.</p>
<h2><a class="anchor" id="autotoc_md2387"></a>
Disable a feature</h2>
<p>To let <a class="el" href="namespaceUnity.html">Unity</a> strip variants related to a feature, make sure you disable it in all the URP Assets in your build.</p>
<p><a class="el" href="namespaceUnity.html">Unity</a> includes the following URP Assets in your build:</p>
<ul>
<li>The URP Asset you set as the default render pipeline asset in <a href="https://docs.unity3d.com/Manual/class-GraphicsSettings.html">Graphics Settings</a>.</li>
<li>Any URP Asset you set as a <b>Render Pipeline Asset</b> in a <a href="https://docs.unity3d.com/Manual/class-QualitySettings.html">Quality Settings level</a> you enable for the current build target.</li>
</ul>
<p>Avoid including URP Assets in your build that use different <a href="urp-universal-renderer.html#rendering-path-comparison">rendering paths</a> because this causes <a class="el" href="namespaceUnity.html">Unity</a> to create two sets of variants for each keyword.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><b>Feature</b>   </th><th class="markdownTableHeadNone"><b>How to disable the feature</b>   </th><th class="markdownTableHeadNone"><b>Shader keywords this turns off</b>   </th><th class="markdownTableHeadNone"><b>Rendering Path</b>    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Accurate G-buffer normals   </td><td class="markdownTableBodyNone">Disable <b>Accurate G-buffer normals</b> in the URP Asset. This has no effect on platforms that use the Vulkan graphics API.   </td><td class="markdownTableBodyNone"><code>_GBUFFER_NORMALS_OCT</code>   </td><td class="markdownTableBodyNone">Deferred    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Additional lights   </td><td class="markdownTableBodyNone">In the <b>URP Asset</b>, in the <b>Lighting section</b>, disable <b>Additional Lights</b>.   </td><td class="markdownTableBodyNone"><code>_ADDITIONAL_LIGHTS</code>, <code>_ADDITIONAL_LIGHTS_VERTEX</code>   </td><td class="markdownTableBodyNone">Forward    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Ambient occlusion   </td><td class="markdownTableBodyNone">Remove the <a href="post-processing-ssao.html">Ambient Occlusion</a> Renderer Feature in all Renderers that URP Assets use.   </td><td class="markdownTableBodyNone"><code>_SCREEN_SPACE_OCCLUSION</code>   </td><td class="markdownTableBodyNone">Forward and Deferred    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Decals   </td><td class="markdownTableBodyNone">Remove the <a href="renderer-feature-decal.html">Decals</a> Renderer Feature in all Renderers that URP Assets use.   </td><td class="markdownTableBodyNone"><code>_DBUFFER_MRT1</code>, <code>_DBUFFER_MRT2</code>, <code>_DBUFFER_MRT3</code>, <code>_DECAL_NORMAL_BLEND_LOW</code>, <code>_DECAL_NORMAL_BLEND_MEDIUM</code>, <code>_DECAL_NORMAL_BLEND_HIGH</code>, <code>_DECAL_LAYERS</code>   </td><td class="markdownTableBodyNone">Forward and Deferred    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Fast sRGB to linear conversion   </td><td class="markdownTableBodyNone">In the <b>URP Asset</b>, in the <b>Post-processing</b> section, disable <b>Fast sRGB/Linear conversions</b>.   </td><td class="markdownTableBodyNone"><code>_USE_FAST_SRGB_LINEAR_CONVERSION</code>   </td><td class="markdownTableBodyNone">Forward and Deferred    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Holes in terrain   </td><td class="markdownTableBodyNone">In the <b>URP Asset</b>, in the <b>Rendering</b> section, disable <b>Terrain Holes</b>.   </td><td class="markdownTableBodyNone"><code>_ALPHATEST_ON</code>   </td><td class="markdownTableBodyNone">Forward    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Light cookies   </td><td class="markdownTableBodyNone">Remove <a href="https://docs.unity3d.com/Manual/Cookies.html">Cookie textures</a> from all the lights in your project.   </td><td class="markdownTableBodyNone"><code>_LIGHT_COOKIES</code>   </td><td class="markdownTableBodyNone">Forward and Deferred    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Rendering Layers for lights   </td><td class="markdownTableBodyNone">Disable <a href="features/rendering-layers.html">Rendering Layers for Lights</a>.   </td><td class="markdownTableBodyNone"><code>_LIGHT_LAYERS</code>   </td><td class="markdownTableBodyNone">Forward and Deferred    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Reflection Probe blending   </td><td class="markdownTableBodyNone">Disable <a href="lighting/reflection-probes.html#configuring-reflection-probe-settings">Probe Blending</a>.   </td><td class="markdownTableBodyNone"><code>_REFLECTION_PROBE_BLENDING</code>   </td><td class="markdownTableBodyNone">Forward and Deferred    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Reflection Probe box projection   </td><td class="markdownTableBodyNone">Disable <a href="lighting/reflection-probes.html#configuring-reflection-probe-settings">Box Projection</a>.   </td><td class="markdownTableBodyNone"><code>_REFLECTION_PROBE_BOX_PROJECTION</code>   </td><td class="markdownTableBodyNone">Forward and Deferred    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Render Pass   </td><td class="markdownTableBodyNone">Disable <b>Native Render</b> in all Renderers that URP Assets use.   </td><td class="markdownTableBodyNone"><code>_RENDER_PASS_ENABLED</code>   </td><td class="markdownTableBodyNone">Forward and Deferred    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Shadows from additional lights   </td><td class="markdownTableBodyNone">In the URP Asset, in the <b>Additional Lights</b> section, disable <b>Cast Shadows</b>.   </td><td class="markdownTableBodyNone"><code>_ADDITIONAL_LIGHT_SHADOWS</code>   </td><td class="markdownTableBodyNone">Forward and Deferred    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Shadows from the main light   </td><td class="markdownTableBodyNone">In the URP Asset, in the <b>Main Light</b> section, disable <b>Cast Shadows</b>. The keywords <a class="el" href="namespaceUnity.html">Unity</a> removes might depend on your settings.   </td><td class="markdownTableBodyNone"><code>_MAIN_LIGHT_SHADOWS</code>, <code>_MAIN_LIGHT_SHADOWS_CASCADE</code>, <code>_MAIN_LIGHT_SHADOWS_SCREEN</code>   </td><td class="markdownTableBodyNone">Forward and Deferred    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Soft shadows   </td><td class="markdownTableBodyNone">In the URP Asset, in the <b>Shadows</b> section, disable <b>Soft shadows</b>.   </td><td class="markdownTableBodyNone"><code>_SHADOWS_SOFT</code>   </td><td class="markdownTableBodyNone">Forward and Deferred   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md2388"></a>
Strip post-processing shader variants</h1>
<p>Enable <b>Strip Unused Post Processing Variants</b> in <a class="el" href="md_ConstructionSite_2Library_2PackageCache_2com_8unity_8render-pipelines_8universal_0d14_80_811_02b8c98dd946abe06dca7ebdbe0d6e09.html">URP Global Settings</a> to strip shader variants for <a class="el" href="md_ConstructionSite_2Library_2PackageCache_2com_8unity_8render-pipelines_8universal_0d14_80_811_b1f6980d6bdeb81615089a51aeb12d8d.html">Volume Overrides</a> you don't use.</p>
<p>For example if your project uses only the Bloom effect, URP keeps Bloom variants but strips all other post-processing variants.</p>
<p><a class="el" href="namespaceUnity.html">Unity</a> checks for Volume Overrides in all scenes, so you can't strip variants by removing a Scene from your build but keeping it in your project.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><b>Volume Override removed</b>   </th><th class="markdownTableHeadNone"><b>Shader keywords this turns off</b>    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Bloom   </td><td class="markdownTableBodyNone"><code>_BLOOM_HQ</code>, <code>BLOOM_HQ_DIRT</code>, <code>_BLOOM_LQ</code>, <code>BLOOM_LQ_DIRT</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Chromatic Aberration   </td><td class="markdownTableBodyNone"><code>_CHROMATIC_ABERRATION</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Film Grain   </td><td class="markdownTableBodyNone"><code>_FILM_GRAIN</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">HDR Grading   </td><td class="markdownTableBodyNone"><code>_HDR_GRADING</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Lens Distortion   </td><td class="markdownTableBodyNone"><code>_DISTORTION</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Tonemapping   </td><td class="markdownTableBodyNone"><code>_TONEMAP_ACES</code>, <code>_TONEMAP_NEUTRAL</code>, <code>_TONEMAP_GRADING</code>   </td></tr>
</table>
<p>You should also enable <b>Strip Screen Coord Override Variants</b> in URP Global Settings, unless you override screen coordinates to support post processing on large numbers of multiple displays ('cluster' displays).</p>
<h1><a class="anchor" id="autotoc_md2389"></a>
Strip XR and VR shader variants</h1>
<p>If you don't use <a href="https://docs.unity3d.com/Manual/XR.html">XR</a> or <a href="https://docs.unity3d.com/Manual/VROverview.html">VR</a>, you can <a href="https://docs.unity3d.com/Documentation/Manual/upm-ui.html">disable the XR and VR modules</a>. This allows URP to strip XR and VR related shader variants from its standard shaders.</p>
<h1><a class="anchor" id="autotoc_md2390"></a>
Remove variants if you use a custom Renderer Feature</h1>
<p>If you create a <a href="xref:UnityEngine.Rendering.Universal.ScriptableRendererFeature">custom Renderer Feature</a>, you can use the <a href="https://docs.unity3d.com/2023.1/Documentation/ScriptReference/ShaderKeywordFilter.FilterAttribute.html">FilterAttribute</a> API to remove shader variants when you enable or disable settings in the <a class="el" href="md_ConstructionSite_2Library_2PackageCache_2com_8unity_8render-pipelines_8universal_0d14_80_811_691b203f5d6feee4924a5c745cae6e21.html">URP Asset</a>.</p>
<p>For example, you can do the following:</p>
<ol type="1">
<li>Use <a href="https://docs.unity3d.com/ScriptReference/SerializeField.html">[SerializeField]</a> to add a Boolean variable to the custom Renderer Feature and add it as a checkbox in the URP Asset Inspector.</li>
<li>Use <a href="https://docs.unity3d.com/2023.1/Documentation/ScriptReference/ShaderKeywordFilter.RemoveIfAttribute.html">ShaderKeywordFilter.RemoveIf</a> to remove shader variants when you enable the checkbox. </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
